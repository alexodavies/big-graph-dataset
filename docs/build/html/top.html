<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ToP (Topology only Pre-training) &mdash; big-graph-dataset 0.01 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Big Graph Dataset!" href="readme.html" />
    <link rel="prev" title="Datasets" href="datasets.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            big-graph-dataset
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="reddit-dataset-example.html">Reddit Example Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Datasets</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ToP (Topology only Pre-training)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#top.GeneralEmbeddingEvaluation"><code class="docutils literal notranslate"><span class="pre">GeneralEmbeddingEvaluation</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#top.GeneralEmbeddingEvaluation.__init__"><code class="docutils literal notranslate"><span class="pre">GeneralEmbeddingEvaluation.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.GeneralEmbeddingEvaluation.embedding_evaluation"><code class="docutils literal notranslate"><span class="pre">GeneralEmbeddingEvaluation.embedding_evaluation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.GeneralEmbeddingEvaluation.get_embeddings"><code class="docutils literal notranslate"><span class="pre">GeneralEmbeddingEvaluation.get_embeddings()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.GeneralEmbeddingEvaluation.vis"><code class="docutils literal notranslate"><span class="pre">GeneralEmbeddingEvaluation.vis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.GeneralEmbeddingEvaluation.centroid_similarities"><code class="docutils literal notranslate"><span class="pre">GeneralEmbeddingEvaluation.centroid_similarities()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">GeneralEmbeddingEvaluation.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">GeneralEmbeddingEvaluation.centroid_similarities()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">GeneralEmbeddingEvaluation.embedding_evaluation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">GeneralEmbeddingEvaluation.get_embeddings()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">GeneralEmbeddingEvaluation.vis()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#top.ToPDataset"><code class="docutils literal notranslate"><span class="pre">ToPDataset</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.__init__"><code class="docutils literal notranslate"><span class="pre">ToPDataset.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset._abc_impl"><code class="docutils literal notranslate"><span class="pre">ToPDataset._abc_impl</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset._download"><code class="docutils literal notranslate"><span class="pre">ToPDataset._download()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset._infer_num_classes"><code class="docutils literal notranslate"><span class="pre">ToPDataset._infer_num_classes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset._is_protocol"><code class="docutils literal notranslate"><span class="pre">ToPDataset._is_protocol</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset._process"><code class="docutils literal notranslate"><span class="pre">ToPDataset._process()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.collate"><code class="docutils literal notranslate"><span class="pre">ToPDataset.collate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.copy"><code class="docutils literal notranslate"><span class="pre">ToPDataset.copy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.data"><code class="docutils literal notranslate"><span class="pre">ToPDataset.data</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.download"><code class="docutils literal notranslate"><span class="pre">ToPDataset.download()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.get"><code class="docutils literal notranslate"><span class="pre">ToPDataset.get()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.get_summary"><code class="docutils literal notranslate"><span class="pre">ToPDataset.get_summary()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.has_download"><code class="docutils literal notranslate"><span class="pre">ToPDataset.has_download</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.has_process"><code class="docutils literal notranslate"><span class="pre">ToPDataset.has_process</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.index_select"><code class="docutils literal notranslate"><span class="pre">ToPDataset.index_select()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.indices"><code class="docutils literal notranslate"><span class="pre">ToPDataset.indices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.len"><code class="docutils literal notranslate"><span class="pre">ToPDataset.len()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.num_classes"><code class="docutils literal notranslate"><span class="pre">ToPDataset.num_classes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.num_edge_features"><code class="docutils literal notranslate"><span class="pre">ToPDataset.num_edge_features</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.num_features"><code class="docutils literal notranslate"><span class="pre">ToPDataset.num_features</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.num_node_features"><code class="docutils literal notranslate"><span class="pre">ToPDataset.num_node_features</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.print_summary"><code class="docutils literal notranslate"><span class="pre">ToPDataset.print_summary()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.process"><code class="docutils literal notranslate"><span class="pre">ToPDataset.process()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.processed_dir"><code class="docutils literal notranslate"><span class="pre">ToPDataset.processed_dir</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.processed_file_names"><code class="docutils literal notranslate"><span class="pre">ToPDataset.processed_file_names</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.processed_paths"><code class="docutils literal notranslate"><span class="pre">ToPDataset.processed_paths</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.raw_dir"><code class="docutils literal notranslate"><span class="pre">ToPDataset.raw_dir</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.raw_file_names"><code class="docutils literal notranslate"><span class="pre">ToPDataset.raw_file_names</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.raw_paths"><code class="docutils literal notranslate"><span class="pre">ToPDataset.raw_paths</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.shuffle"><code class="docutils literal notranslate"><span class="pre">ToPDataset.shuffle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#top.ToPDataset.to_datapipe"><code class="docutils literal notranslate"><span class="pre">ToPDataset.to_datapipe()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#top.compute_top_scores"><code class="docutils literal notranslate"><span class="pre">compute_top_scores()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="readme.html">Big Graph Dataset!</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">big-graph-dataset</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">ToP (Topology only Pre-training)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/top.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-top">
<span id="top-topology-only-pre-training"></span><h1>ToP (Topology only Pre-training)<a class="headerlink" href="#module-top" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="top.GeneralEmbeddingEvaluation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">top.</span></span><span class="sig-name descname"><span class="pre">GeneralEmbeddingEvaluation</span></span><a class="reference internal" href="_modules/top/top.html#GeneralEmbeddingEvaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#top.GeneralEmbeddingEvaluation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for evaluating embeddings and visualizing the results.</p>
<dl class="py method">
<dt class="sig sig-object py" id="top.GeneralEmbeddingEvaluation.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/top/top.html#GeneralEmbeddingEvaluation.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#top.GeneralEmbeddingEvaluation.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes the GeneralEmbeddingEvaluation object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.GeneralEmbeddingEvaluation.embedding_evaluation">
<span class="sig-name descname"><span class="pre">embedding_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loaders</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/top/top.html#GeneralEmbeddingEvaluation.embedding_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#top.GeneralEmbeddingEvaluation.embedding_evaluation" title="Permalink to this definition"></a></dt>
<dd><p>Performs embedding evaluation using the given encoder, train loaders, and names.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.GeneralEmbeddingEvaluation.get_embeddings">
<span class="sig-name descname"><span class="pre">get_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loaders</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/top/top.html#GeneralEmbeddingEvaluation.get_embeddings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#top.GeneralEmbeddingEvaluation.get_embeddings" title="Permalink to this definition"></a></dt>
<dd><p>Retrieves the embeddings from the encoder and loaders.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.GeneralEmbeddingEvaluation.vis">
<span class="sig-name descname"><span class="pre">vis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_embeddings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separate_embeddings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/top/top.html#GeneralEmbeddingEvaluation.vis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#top.GeneralEmbeddingEvaluation.vis" title="Permalink to this definition"></a></dt>
<dd><p>Visualizes the embeddings using UMAP and PCA projections.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.GeneralEmbeddingEvaluation.centroid_similarities">
<span class="sig-name descname"><span class="pre">centroid_similarities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embeddings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/top/top.html#GeneralEmbeddingEvaluation.centroid_similarities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#top.GeneralEmbeddingEvaluation.centroid_similarities" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the pairwise similarities between the centroids of the embeddings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/top/top.html#GeneralEmbeddingEvaluation.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">centroid_similarities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embeddings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/top/top.html#GeneralEmbeddingEvaluation.centroid_similarities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Permalink to this definition"></a></dt>
<dd><p>Calculate centroid similarities for a given set of embeddings and names.</p>
<p>Parameters:
embeddings (list of numpy arrays): List of embeddings, where each embedding is a numpy array.
names (list of str): List of names corresponding to the embeddings.</p>
<p>Returns:
None</p>
<p>This method calculates the centroid similarities for a given set of embeddings. It first calculates the centroid
for each embedding by taking the mean along the axis 0. Then, it calculates the pairwise similarities between
the centroids using cosine similarity. Finally, it visualizes the pairwise similarities as a heatmap and saves
the plot as “outputs/pairwise-similarity.png”.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">embedding_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loaders</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/top/top.html#GeneralEmbeddingEvaluation.embedding_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the embeddings generated by the encoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encoder</strong> – The encoder model used to generate the embeddings.</p></li>
<li><p><strong>train_loaders</strong> – A list of data loaders for the data.</p></li>
<li><p><strong>names</strong> – A list of names corresponding to the data loaders.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">get_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loaders</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/top/top.html#GeneralEmbeddingEvaluation.get_embeddings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Permalink to this definition"></a></dt>
<dd><p>Get embeddings for the given encoder and loaders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encoder</strong> – The encoder model.</p></li>
<li><p><strong>loaders</strong> – A list of data loaders.</p></li>
<li><p><strong>names</strong> – A list of names corresponding to the loaders.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the concatenated embeddings of all loaders and a list of separate embeddings for each loader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">vis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_embeddings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separate_embeddings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/top/top.html#GeneralEmbeddingEvaluation.vis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Permalink to this definition"></a></dt>
<dd><p>Visualizes the embeddings using UMAP and PCA projections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_embeddings</strong> (<em>numpy.ndarray</em>) – The combined embeddings of all graphs.</p></li>
<li><p><strong>separate_embeddings</strong> (<em>list</em>) – A list of separate embeddings for each graph.</p></li>
<li><p><strong>names</strong> (<em>list</em>) – A list of names corresponding to each graph.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="top.ToPDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">top.</span></span><span class="sig-name descname"><span class="pre">ToPDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/top/top_dataset.html#ToPDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#top.ToPDataset" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">InMemoryDataset</span></code></p>
<p>Processes an InMemoryDataset into a ToP dataset by removing node and edge features.</p>
<p>Based on the paper:</p>
<blockquote>
<div><p><cite>Towards Generalised Pre-Training of Graph Models, Davies, A. O., Green, R. W., Ajmeri, N. S., and Silva Filho, T. M.,  arXiv e-prints, 2024. doi:10.48550/arXiv.2311.03976.</cite></p>
</div></blockquote>
<p>The resulting dataset is topology-only, intended for pre-training with ToP, and as such this module does not produce validation/test splits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> (<em>str</em>) – Root directory where the dataset should be saved. The dataset will be saved in <cite>root</cite>/train-top.pt</p></li>
<li><p><strong>original_dataset</strong> (<em>InMemoryDataset</em>) – The original dataset to convert to ToP format.</p></li>
<li><p><strong>num</strong> (<em>int</em>) – The number of samples to take from the original dataset. <cite>num=-1</cite> will convert all available samples from the original. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">-1</span></code>).</p></li>
<li><p><strong>transform</strong> (<em>callable</em><em>, </em><em>optional</em>) – A function/transform that takes in an <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code> object and returns a transformed version. The data object will be transformed before every access. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>pre_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) – A function/transform that takes in an <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code> object and returns a transformed version. The data object will be transformed before being saved to disk. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>pre_filter</strong> (<em>callable</em><em>, </em><em>optional</em>) – A function that takes in an <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code> object and returns a boolean value, indicating whether the data object should be included in the final dataset. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/top/top_dataset.html#ToPDataset.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#top.ToPDataset.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="top.ToPDataset._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#top.ToPDataset._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset._download">
<span class="sig-name descname"><span class="pre">_download</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#top.ToPDataset._download" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset._infer_num_classes">
<span class="sig-name descname"><span class="pre">_infer_num_classes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#top.ToPDataset._infer_num_classes" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="top.ToPDataset._is_protocol">
<span class="sig-name descname"><span class="pre">_is_protocol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#top.ToPDataset._is_protocol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset._process">
<span class="sig-name descname"><span class="pre">_process</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#top.ToPDataset._process" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset.collate">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#top.ToPDataset.collate" title="Permalink to this definition"></a></dt>
<dd><p>Collates a Python list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code> objects
to the internal storage format of
<code class="xref py py-class docutils literal notranslate"><span class="pre">InMemoryDataset</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]]]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#top.ToPDataset.copy" title="Permalink to this definition"></a></dt>
<dd><p>Performs a deep-copy of the dataset. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">idx</span></code> is not given,
will clone the full dataset. Otherwise, will only clone a subset of the
dataset from indices <code class="xref py py-obj docutils literal notranslate"><span class="pre">idx</span></code>.
Indices can be slices, lists, tuples, and a <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code> or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code> of type long or bool.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">InMemoryDataset</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="top.ToPDataset.data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#top.ToPDataset.data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset.download">
<span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#top.ToPDataset.download" title="Permalink to this definition"></a></dt>
<dd><p>Downloads the dataset to the <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.raw_dir</span></code> folder.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#top.ToPDataset.get" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset.get_summary">
<span class="sig-name descname"><span class="pre">get_summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#top.ToPDataset.get_summary" title="Permalink to this definition"></a></dt>
<dd><p>Collects summary statistics for the dataset.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="top.ToPDataset.has_download">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_download</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#top.ToPDataset.has_download" title="Permalink to this definition"></a></dt>
<dd><p>Checks whether the dataset defines a <a class="reference internal" href="#top.ToPDataset.download" title="top.ToPDataset.download"><code class="xref py py-meth docutils literal notranslate"><span class="pre">download()</span></code></a> method.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="top.ToPDataset.has_process">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_process</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#top.ToPDataset.has_process" title="Permalink to this definition"></a></dt>
<dd><p>Checks whether the dataset defines a <a class="reference internal" href="#top.ToPDataset.process" title="top.ToPDataset.process"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process()</span></code></a> method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset.index_select">
<span class="sig-name descname"><span class="pre">index_select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#top.ToPDataset.index_select" title="Permalink to this definition"></a></dt>
<dd><p>Creates a subset of the dataset from specified indices <code class="xref py py-obj docutils literal notranslate"><span class="pre">idx</span></code>.
Indices <code class="xref py py-obj docutils literal notranslate"><span class="pre">idx</span></code> can be a slicing object, <em>e.g.</em>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">[2:5]</span></code>, a
list, a tuple, or a <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code> of type
long or bool.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset.indices">
<span class="sig-name descname"><span class="pre">indices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#top.ToPDataset.indices" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset.len">
<span class="sig-name descname"><span class="pre">len</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#top.ToPDataset.len" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="top.ToPDataset.num_classes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_classes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#top.ToPDataset.num_classes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="top.ToPDataset.num_edge_features">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_edge_features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#top.ToPDataset.num_edge_features" title="Permalink to this definition"></a></dt>
<dd><p>Returns the number of features per edge in the dataset.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="top.ToPDataset.num_features">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#top.ToPDataset.num_features" title="Permalink to this definition"></a></dt>
<dd><p>Returns the number of features per node in the dataset.
Alias for <a class="reference internal" href="#top.ToPDataset.num_node_features" title="top.ToPDataset.num_node_features"><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_node_features</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="top.ToPDataset.num_node_features">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_node_features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#top.ToPDataset.num_node_features" title="Permalink to this definition"></a></dt>
<dd><p>Returns the number of features per node in the dataset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset.print_summary">
<span class="sig-name descname"><span class="pre">print_summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#top.ToPDataset.print_summary" title="Permalink to this definition"></a></dt>
<dd><p>Prints summary statistics of the dataset to the console.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset.process">
<span class="sig-name descname"><span class="pre">process</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/top/top_dataset.html#ToPDataset.process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#top.ToPDataset.process" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="top.ToPDataset.processed_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">processed_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#top.ToPDataset.processed_dir" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="top.ToPDataset.processed_file_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">processed_file_names</span></span><a class="headerlink" href="#top.ToPDataset.processed_file_names" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="top.ToPDataset.processed_paths">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">processed_paths</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#top.ToPDataset.processed_paths" title="Permalink to this definition"></a></dt>
<dd><p>The absolute filepaths that must be present in order to skip
processing.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="top.ToPDataset.raw_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">raw_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#top.ToPDataset.raw_dir" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="top.ToPDataset.raw_file_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">raw_file_names</span></span><a class="headerlink" href="#top.ToPDataset.raw_file_names" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="top.ToPDataset.raw_paths">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">raw_paths</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#top.ToPDataset.raw_paths" title="Permalink to this definition"></a></dt>
<dd><p>The absolute filepaths that must be present in order to skip
downloading.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset.shuffle">
<span class="sig-name descname"><span class="pre">shuffle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_perm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#top.ToPDataset.shuffle" title="Permalink to this definition"></a></dt>
<dd><p>Randomly shuffles the examples in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>return_perm</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set to <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>, will also
return the random permutation used to shuffle the dataset.
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="top.ToPDataset.to_datapipe">
<span class="sig-name descname"><span class="pre">to_datapipe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#top.ToPDataset.to_datapipe" title="Permalink to this definition"></a></dt>
<dd><p>Converts the dataset into a <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.DataPipe</span></code>.</p>
<p>The returned instance can then be used with <a href="#id5"><span class="problematic" id="id6">:pyg:`PyG's`</span></a> built-in
<code class="xref py py-class docutils literal notranslate"><span class="pre">DataPipes</span></code> for baching graphs as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torch_geometric.datasets</span> <span class="kn">import</span> <span class="n">QM9</span>

<span class="n">dp</span> <span class="o">=</span> <span class="n">QM9</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;./data/QM9/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_datapipe</span><span class="p">()</span>
<span class="n">dp</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">batch_graphs</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">dp</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>See the <a class="reference external" href="https://pytorch.org/data/main/tutorial.html">PyTorch tutorial</a> for further background
on DataPipes.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="top.compute_top_scores">
<span class="sig-prename descclassname"><span class="pre">top.</span></span><span class="sig-name descname"><span class="pre">compute_top_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datasets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/top/top.html#compute_top_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#top.compute_top_scores" title="Permalink to this definition"></a></dt>
<dd><p>Computes the top scores for graph structures using the ToP encoder.</p>
<p>ToP scores use a pre-trained ToP model to compute the similarity between graphs across datasets.</p>
<p>This function will also produce embedding visualisations using GeneralEmbeddingEvaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datasets</strong> (<em>list</em>) – A list of datasets containing graph structures.</p></li>
<li><p><strong>names</strong> (<em>list</em>) – A list of names corresponding to each dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="datasets.html" class="btn btn-neutral float-left" title="Datasets" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="readme.html" class="btn btn-neutral float-right" title="Big Graph Dataset!" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Alex O. Davies.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>